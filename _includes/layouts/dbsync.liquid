{% include 'parts/head.liquid' %}
		{% comment %}
		<script>
			if (window.netlifyIdentity) {
				window.netlifyIdentity.on("init", (user) => {
					// if (!user) {
					// 	window.netlifyIdentity.on("login", () => {
					// 		console.log("ACCESS GRANTED");
					// 		// document.location.href = "/admin/";
					// 	});
					// } else {
					// 	console.log("ACCESS DENIED");
					// }
					console.log(user);
					const dbsync = document.getElementById("dbsync");
					dbsync.style.display = "block";
				});
			}
		</script>


		<!-- DB Sync Section -->
		<section id="dbsync-section" class="dbsync-section">
			<div class="container">
				<div class="row space-100-top-bottom">
					<div class="columns small-9 inline-middle">
						<div class="h3 font-h">Database Sync</div>
					</div>
					<div class="columns small-3 inline-middle text-right">
						<!-- <div data-netlify-identity-menu></div> -->
						<div class="button fill-blue" data-netlify-identity-button></div>
					</div>
				</div>
				<div class="row">
					<div class="columns small-12">
						<div id="dbsync" style="display: none;">
						    <button id="fetch-variations">Fetch Variations</button>
						    <button id="fetch-categories">Fetch Categories</button>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!-- END: DB Sync Section -->
		{% endcomment %}


		<!-- DB Sync Section -->
		<section id="dbsync-section" class="dbsync-section">
			<div class="container">
				<div class="row space-100-top-bottom">
					<div class="columns small-9 inline-middle">
						<div id="userTitle" class="h3 font-h">Admin Login</div>
					</div>
					<div class="columns small-3 inline-middle text-right">
						<!-- <div data-netlify-identity-menu></div> -->
						<div class="button fill-blue" data-netlify-identity-button></div>
					</div>
				</div>
				<div class="row">
					<div class="columns small-12">
						<div id="dbsync" style="display: none;">
		    				<h3>Secret Content</h3><br>
						    <button id="fetch-variations">Fetch Variations</button>
						    <button id="fetch-categories">Fetch Categories</button>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!-- END: DB Sync Section -->

		<script>
		const dbsync = document.getElementById('dbsync');
		const userTitle = document.getElementById('userTitle');

		function updateElementVisibility() {
			const user = window.netlifyIdentity.currentUser();
			
			if (user) {
				dbsync.style.display = 'block';
			} else {
				dbsync.style.display = 'none';
			}

			function displayUsername() {
				if (user) {
					// Check for common username properties, adjust as needed based on your auth provider
					const username = user.name || 'User';
					userTitle.textContent = `Welcome, ${username}!`;
				} else {
					userTitle.textContent = 'Admin Login';
				}
			}

			// Call on initial load
			displayUsername();
		}

		if (window.netlifyIdentity) {
			window.netlifyIdentity.on('init', user => {
				updateElementVisibility();
			});

			window.netlifyIdentity.on('login', user => {
				updateElementVisibility();
			});

			window.netlifyIdentity.on('logout', () => {
				updateElementVisibility();
			});
		}
		</script>



{% include 'parts/foot.liquid' %}
